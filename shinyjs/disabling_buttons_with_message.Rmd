---
title: "Disabling button while processing"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny    
---

```{r setup, include=FALSE}
# https://stackoverflow.com/a/40622303/5270873

library(flexdashboard)
library(shinyjs)
```

Column {data-width=650}
-----------------------------------------------------------------------

### Demo

```{r}
useShinyjs(rmd = TRUE)

actionButton("Button1", "Run")
shinyjs::hidden(p(id = "text1", "Processing..."))

plotOutput("plot")
```


```{r}
plotReady <- reactiveValues(ok = FALSE)
    
observeEvent(input$Button1, {
    shinyjs::disable("Button1")
    shinyjs::show("text1")
    plotReady$ok <- FALSE
    
    # do some cool and complex stuff
    Sys.sleep(4)
    plotReady$ok <- TRUE
})  
    
output$plot <-renderPlot({
    if (plotReady$ok) {
        shinyjs::enable("Button1")
        shinyjs::hide("text1")
        hist(rnorm(100, 4, 1),breaks = 50)
    }
})
```

